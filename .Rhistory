library(car)
library(MASS)
library(ggplot2)
#
# negative binomial regression model for the analysis of the influence of ER, ST, TEA, AI and NRC [explanation below]
# on the number campaigns conducted
#
# get the data
# Turkey already excluded
#
data <- read.table(file="/Users/tselhorst/Desktop/Table4paper_cc_woTurkey.txt", header=TRUE, sep="\t")
attach(data)
data
#
# description of the data
#
tapply(Y, ER, summary)
tapply(ST, ER, summary)
tapply(TEA, ER, summary)
tapply(AI, ER, summary)
tapply(NRC, ER, summary)
#
# Correlaton matrix plot
#
scatterplotMatrix(~Y+log(ST)+TEA+AI+log(NRC) | ER, reg.line=FALSE, smoother=FALSE)
library(lattice)
scatterplotMatrix(~Y+log(ST)+TEA+AI+log(NRC) | ER, reg.line=FALSE, smoother=FALSE)
install.packages("car")
library(car)
scatterplotMatrix(~Y+log(ST)+TEA+AI+log(NRC) | ER, reg.line=FALSE, smoother=FALSE)
library(Hmisc)
d <- data.frame(log(ST),TEA,AI,log(NRC))
df <- data.matrix(d)
rcorr(df, type="spearman")
install.packages("Hmisc")
library(Hmisc)
d <- data.frame(log(ST),TEA,AI,log(NRC))
df <- data.matrix(d)
rcorr(df, type="spearman")
#
# Perform main effects nb regression model
#
# Parameters of the model are:
#   Y   : number of OIF campaigns
#   ER  : eradication status (finished | not finished)
#   ST  : size of territory (km^2)
#   TEA : territory ever affected (km^2)
#   AI  : area index
#   NRC : number of rabies cases at the beginning of ORV
#
# negative binomial model with and without log transformed data
#
summary(nbFit <- glm.nb(Y ~ (ER + ST + TEA + AI + NRC), data = data))
summary(nbFit <- glm.nb(Y ~ (ER + log(ST) + TEA + AI + log(NRC)), data = data))
summary(nbFit <- glm.nb(Y ~ (ER + ST + TEA + AI + NRC), data = data))
summary(nbFit.log <- glm.nb(Y ~ (ER + log(ST) + TEA + AI + log(NRC)), data = data))
#
# analyse the effect of ER
#
nbFit_wo_ER.log <- update(nbFit.log, . ~ . -ER)
anova(nbFit.log, nbFit_wo_ER.log)
#
# why not use the poisson model?
#
# setup a poission regression model with is nested in the negative binomial model and assuming that the disperion parameter is
# constant.
#
summary(poiFit <- glm(Y ~ (ER + ST + TEA + AI + NRC), family = poisson, data = data))
summary(poiFit.log <- glm(Y ~ (ER + log(ST) + TEA + AI + log(NRC)), family = poisson, data = data))
#
# Compare the negative binomial to the poission model
#  This is to answer question 8 of reviewer 2
#  The negbin is superior to the poi model.
#  The difference is significant!
#
chi <- 2 * (logLik(nbFit.log) - logLik(poiFit.log))
chi
pchisq(chi, df = 1, lower.tail = FALSE)
#
# Goodness of fit of negbin
#
with(nbFit.log, cbind(res.deviance = deviance, df=df.residual, p = pchisq(deviance, df.residual, lower.tail=FALSE)))
#
# include and test 2nd order interactions for nbFit model
#
stepNb <- stepAIC(nbFit.log,~.^2, direction="both")
stepNb$anova
summary(stepNb)
#
# goodness of fit
#
with(stepNb, cbind(res.deviance = deviance, df=df.residual, p = pchisq(deviance, df.residual, lower.tail=FALSE)))
data
